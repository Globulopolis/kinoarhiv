Kinoarhiv=window.Kinoarhiv||{};(function(b,a){b.getFormToken=function(){return jQuery('input[type="hidden"]').filter(function(){return/^[0-9A-F]{32}$/i.test(this.name)}).attr("name")};b.checkall=function(d,c){jQuery(a).ready(function(e){if(e(d).is(":checked")){e(":checkbox",c).prop("checked",true)}else{e(":checkbox",c).prop("checked",false)}})};b.blockUI=function(c){jQuery(a).ready(function(d){if(c==="show"){d('<div class="modal-backdrop" style="z-index: 10002;"></div>').appendTo(a.body).show()}else{d(".modal-backdrop").remove()}})};b.showLoading=function(d,c){jQuery(a).ready(function(h){var l=h(".modal-loading:hidden").length++;if(d==="show"){var j=(c.selector==="document"||c.selector==="body")?"fixed":"absolute";var g=c.offset(),k=typeof g==="undefined"?0:g.top,f=typeof g==="undefined"?0:g.left,e=c.outerWidth(),m=c.innerHeight(),i='<div class="modal-backdrop modal-loading" id="mdl'+l+'" style="position: '+j+"; top: "+k+"px; left: "+f+"px; width: "+e+"px; height: "+m+'px; z-index: 10001;"><div class="ajax-loading" style="cursor: pointer;" title="Press to close">&nbsp;</div></div>';if(c.selector==="document"||c.selector==="body"){h(i).prependTo(c)}else{h(i).insertAfter(c)}h(".modal-backdrop").on("click",".ajax-loading",function(){h(this).parent().remove()})}else{if(c.selector==="document"||c.selector==="body"){c.find("div#mdl"+l).remove()}else{c.next("div#mdl"+l).remove()}}})};b.openWindow=function(c){var e=window.open(c),d=!!a.getElementById("system-message-container")?"#system-message-container":"body";if(!e){showMsg(d,KA_vars.language.COM_KA_NEWWINDOW_BLOCKED_A+c+KA_vars.language.COM_KA_NEWWINDOW_BLOCKED_B)}}}(Kinoarhiv,document));function empty(b){var e,d,c,a,f=[e,null,false,0,"","0"];for(c=0,a=f.length;c<a;c++){if(b===f[c]){return true}}if(typeof b==="object"){for(d in b){if(b.hasOwnProperty(d)){return false}}return true}return false}function formatItemTitle(c,a,b,d){var e="";if(!empty(c)){if(typeof c!=="undefined"&&!empty(c)){e+=c}if(!empty(c)&&!empty(a)){e+=(typeof d!=="undefined"&&!empty(d)?d:" / ")}if(typeof a!=="undefined"&&!empty(a)){e+=a}if(!empty(b)&&b!=="0000"&&b!=="0000-00-00"){e+=" ("+b+")"}return e}else{return""}}function showMsg(a,e,b,d,c){b=(typeof b==="undefined")?"after":b;d=(typeof d==="undefined"||empty(d))?"close":d;c=(typeof c==="undefined"||empty(c))?KA_vars.language.COM_KA_CLOSE:c;a=(typeof a==="object")?a:jQuery(a);if(jQuery.fn.aurora){a.aurora({text:e,placement:b,button:d,button_title:"["+c+"]"})}}function blockUI(a){if(a==="show"){jQuery('<div class="modal-backdrop"></div>').appendTo(document.body).show()}else{jQuery(".modal-backdrop").remove()}}jQuery(document).ready(function(a){if(jQuery.fn.select2){a(".hasAutocomplete").each(function(i,c){if(a(c).data("select2-disabled")){return}var h=a(c),t={},p=h.data("url"),b=h.data("lang")||"",q=h.data("content"),s=h.attr("multiple"),g=h.data("remote"),d=h.data("sortable"),n=h.data("minimum-input-length"),j=h.data("maximum-selection-size"),m=h.data("remote-show-all"),l=h.data("ignore-ids")||"",k=KA_vars.api_root||"",r=KA_vars.img_root||"";t.placeholder=!empty(h.data("placeholder"))?h.data("placeholder"):KA_vars.language.JGLOBAL_SELECT_AN_OPTION;t.allowClear=h.data("allow-clear");if(n){t.minimumInputLength=parseInt(n,10)}if(j){t.maximumSelectionSize=parseInt(j,10)}if(g==true||(g==false&&a.inArray(q,["countries","vendors","genres-movie","genres-name","tags","amplua"]))){if(s){t.multiple=true}if(!p){if(!empty(l)){l="&ignore_ids[]="+[l].join("&ignore_ids[]=")}if(!empty(b)){b="&data_lang="+b}p=k+"index.php?option=com_kinoarhiv&task=api.data&content="+q+"&format=json&tmpl=component&lang="+KA_vars.language.tag.substr(0,2)+b+l+"&"+Kinoarhiv.getFormToken()+"=1"}t.id=function(u){return !empty(h.data("key"))?u[h.data("key")]:u.value};t.ajax={cache:true,url:p,quietMillis:250,data:function(u,v){return{term:u,showAll:m?1:0,page:v}},results:function(w,v){var u=(v*30)<w.total_count;return{results:w,more:u}}};t.initSelection=function(u,w){var v=a(u).val();if(!empty(v)){a.ajax(p,{data:{id:v,multiple:s?1:0},cache:true}).done(function(x){w(x)})}}}else{if(d=="true"||d){var f=h.data("content-value"),e=f.length;if(s){t.multiple=true}t.initSelection=function(u,w){var v=[];if(q=="countries"){a(u.val().split(",")).each(function(){var x=0;for(x;x<e;x++){if(f[x]["value"]==this){v.push({value:f[x]["value"],text:f[x]["text"],code:f[x]["code"]})}}})}else{a(u.val().split(",")).each(function(){var x=0;for(x;x<e;x++){if(f[x]["value"]==this){v.push({value:f[x]["value"],text:f[x]["text"]})}}})}w(v)};t.id=function(u){return !empty(h.data("key"))?u[h.data("key")]:u.value};t.query=function(w){var u={results:[]},v=0;if(q==="countries"){for(v;v<e;v++){u.results.push({value:f[v]["value"],text:f[v]["text"],code:f[v]["code"]})}}else{u=f}w.callback(u)}}}t.formatResult=function(w){var x="";if(q==="countries"){if(w.length<1){return""}else{var u=(g==true||(d=="true"||d))?w.code:a(w.element).data("country-code");return'<img class="flag-dd" src="'+r+"media/com_kinoarhiv/images/icons/countries/"+u+'.png"/>'+w.text}}else{if(q==="names"){return g==true?formatItemTitle(w.name,w.latin_name,w.date_of_birth):w.text}else{if(q==="movies"){var v=(g==true||(d=="true"||d))?w.year:a(w.element).data("year");x=!empty(w.text)?w.text:w.title;return formatItemTitle(x,"",v)}else{return w.text}}}};t.formatSelection=function(w){var x="";if(q==="countries"){if(w.length<1){return""}else{var u=(g==true||(d=="true"||d))?w.code:a(w.element).data("country-code");return'<img class="flag-dd" src="'+r+"media/com_kinoarhiv/images/icons/countries/"+u+'.png"/>'+w.text}}else{if(q=="names"){return g==true?formatItemTitle(w.name,w.latin_name,w.date_of_birth):w.text}else{if(q=="movies"){var v=(g==true||(d=="true"||d))?w.year:a(w.element).data("year");x=!empty(w.text)?w.text:w.title;return formatItemTitle(x,"",v)}else{return w.text}}}};t.escapeMarkup=function(u){return u};var o=h.select2(t);if(d=="true"||d){o.select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){h.select2("onSortStart")},update:function(){h.select2("onSortEnd")}})}})}if(jQuery.fn.slider){a(".hasSlider").each(function(b,c){var e=a(c);if(e.data("slider-disabled")){return}var d=e.slider();d.on("slide",function(f){if(typeof e.data("slider-input-min")!=="undefined"&&!empty(e.data("slider-input-min"))){a(e.data("slider-input-min")).val(f.value[0])}if(typeof e.data("slider-input-max")!=="undefined"&&!empty(e.data("slider-input-max"))){a(e.data("slider-input-max")).val(f.value[1])}})})}});